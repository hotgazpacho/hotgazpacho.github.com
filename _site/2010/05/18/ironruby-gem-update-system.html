<!DOCTYPE html>
<html>
  <head>
    <title>IronRuby: `gem update --system`</title>
  </head>

  <body>
    <h1>IronRuby: `gem update --system`</h1>

    <p>After reading <a href='http://marcinobel.com/index.php/bug-invalid-exec_format-ir' target='_blank'>this article</a> on getting around the <strong><em>invalid exec_format “ir”, no %s</em></strong> issue when trying to update RubyGems in IronRuby, I came up with a better solution (rather than essentially swallowing the exception) to the problem. Stick the following file in:<tt> %IronRubyInstallDir%\lib\ruby\site_ruby\1.8\rubygems\defaults\ironruby.rb</tt></p>
<p>module Gem def self.default_exec_format exec_format = ConfigMap<span>:ruby_install_name</span>.sub(&#8216;ir&#8217;, &#8216;%s&#8217;) rescue &#8216;%s&#8217;</p>

<pre><code>unless exec_format =~ /%s/ then
  raise Gem::Exception,
    &quot;[BUG] invalid exec_format #{exec_format.inspect}, no %s&quot;
end

exec_format</code></pre>

<p>end end <span>/ccW_ruby</span> <p>I'm working on getting this contributed to the IronRuby project, as judging from the RubyGems sources, as well as the RubyGems sources distributed with JRuby, this is intended to be distributed by the Ruby implementation, not RubyGems itself.</p> <p>Also note, this allows one to:</p> <code>ir -S gem install bundler</code></p>
  </body>
</html>
